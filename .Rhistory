df$title<-titles
return(titles)
}
test<-extractMeta(out)
extractMeta<-function(y){
#Make data frame to poplate
df<-data.frame()
#Run getDate to get dates
dates<-map(y, getDate)
dates<-reduce(dates,c)
#Run getTitle to get Title
titles<-map(y, getTitle)
titles<-reduce(titles,c)
df$title<-titles
}
test<-extractMeta(out)
extractMeta<-function(y){
#Make data frame to poplate
df<-data.frame()
#Run getDate to get dates
dates<-map(y, getDate)
dates<-reduce(dates,c)
#Run getTitle to get Title
titles<-map(y, getTitle)
titles<-reduce(titles,c)
}
test<-extractMeta(out)
rm(dates)
test
extractMeta<-function(y){
#Make data frame to poplate
#df<-data.frame()
#Run getDate to get dates
dates<-map(y, getDate)
dates<-reduce(dates,c)
#Run getTitle to get Title
titles<-map(y, getTitle)
titles<-reduce(titles,c)
df<-data.frame(titles, dates)
return(df)
}
extractMeta(out)
test<-extractMeta(out)
str(test)
getPublication<-function(x){
#Make a data.frame
origin<-gsub('Publication title:', '', grep('^Publication title:', x, value=TRUE))
}
extractMeta<-function(y){
#Make data frame to poplate
#df<-data.frame()
#Run getDate to get dates
dates<-map(y, getDate)
dates<-reduce(dates,c)
#Run getTitle to get Title
titles<-map(y, getTitle)
titles<-reduce(titles,c)
#Run Publication Title to get Publication Title
origin<-map(y, getPublication)
origin<-reduce(origin,c)
df<-data.frame(titles, dates, origins)
return(df)
}
test<-extractMeta(out)
df<-data.frame(titles, dates, origin)
return(df)
extractMeta<-function(y){
#Make data frame to poplate
#df<-data.frame()
#Run getDate to get dates
dates<-map(y, getDate)
dates<-reduce(dates,c)
#Run getTitle to get Title
titles<-map(y, getTitle)
titles<-reduce(titles,c)
#Run Publication Title to get Publication Title
origin<-map(y, getPublication)
origin<-reduce(origin,c)
df<-data.frame(titles, dates, origin)
return(df)
}
test<-extractMeta(out)
str(test)
extractMeta<-function(y){
#Make data frame to poplate
#df<-data.frame()
#Run getDate to get dates
dates<-map(y, getDate)
dates<-reduce(dates,c)
#Run getTitle to get Title
titles<-map(y, getTitle)
titles<-reduce(titles,c)
#Run Publication Title to get Publication Title
origin<-map(y, getPublication)
origin<-reduce(origin,c)
#Run get full text
text<-map(y, paste(getFullText, collapse=""))
df<-data.frame(titles, dates, origin, text)
return(df)
}
test<-extractMeta(out)
getFullText <- function(x){
start <- grep('Full [Tt]ext:', x)
end <- grep(':', x)
end <- end[which(end > start)[1]] - 1
x[start:end]
}
test<-extractMeta(out)
out
out[[1]]
getFullText(out[[1]])
paste(getFullText(out[[1]]), collapse="")
out %>%
map(., getFullText)
out %>%
map(., paste(getFullText), collapse="")
out %>%
map(., getFullText) %>%
map(., paste(., collapse=""))
out %>%
map(., getFullText)
map(., function(x) paste(x, collapse=""))
out %>%
map(., getFullText) %>%
map(., function(x) paste(x, collapse=""))
extractMeta<-function(y){
#Make data frame to poplate
#df<-data.frame()
#Run getDate to get dates
dates<-map(y, getDate)
dates<-reduce(dates,c)
#Run getTitle to get Title
titles<-map(y, getTitle)
titles<-reduce(titles,c)
#Run Publication Title to get Publication Title
origin<-map(y, getPublication)
origin<-reduce(origin,c)
#Run get full text
text<-map(y, getFullText) %>%
map(., function(x) paste(x, collapse=""))
df<-data.frame(titles, dates, origin, text)
return(df)
}
extractMeta(out)
test<-extractMeta(out)
glimpse(test)
extractMeta<-function(y){
#Make data frame to poplate
#df<-data.frame()
#Run getDate to get dates
dates<-map(y, getDate)
dates<-reduce(dates,c)
#Run getTitle to get Title
titles<-map(y, getTitle)
titles<-reduce(titles,c)
#Run Publication Title to get Publication Title
origin<-map(y, getPublication)
origin<-reduce(origin,c)
#Run get full text
text<-map(y, getFullText) %>%
map(., function(x) paste(x, collapse=""))
text<-reduce(text,c)
df<-data.frame(titles, dates, origin, text)
return(df)
}
test<-extractMeta(out)
glimpse(test)
?regex
getFullText <- function(x){
start <- grep('Full [Tt]ext:', x)
end <- grep('^[:alpha:]+: ', x)
end <- end[which(end > start)[1]] - 1
x[start:end]
}
#Take out Full text:
?str_remove_all
extractMeta<-function(y){
#Make data frame to poplate
#df<-data.frame()
#Run getDate to get dates
dates<-map(y, getDate)
dates<-reduce(dates,c)
#Run getTitle to get Title
titles<-map(y, getTitle)
titles<-reduce(titles,c)
#Run Publication Title to get Publication Title
origin<-map(y, getPublication)
origin<-reduce(origin,c)
#Run get full text
text<-map(y, getFullText) %>%
map(., function(x) paste(x, collapse="")) %>%
map(., function(x) str_remove_all(x, "Full [Tt]ext: "))
text<-reduce(text,c)
df<-data.frame(titles, dates, origin, text)
return(df)
}
extractMeta(out)
extractMeta<-function(y){
#Make data frame to poplate
#df<-data.frame()
#Run getDate to get dates
dates<-map(y, getDate)
dates<-reduce(dates,c)
#Run getTitle to get Title
titles<-map(y, getTitle)
titles<-reduce(titles,c)
#Run Publication Title to get Publication Title
origin<-map(y, getPublication)
origin<-reduce(origin,c)
#Run get full text
text<-map(y, getFullText) %>%
map(., function(x) paste(x, collapse=""))
text<-reduce(text,c)
df<-data.frame(titles, dates, origin, text)
return(df)
}
extractMeta(out)
getFullText <- function(x){
start <- grep('Full [Tt]ext:', x)
end <- grep('^[:alpha:]+:', x)
end <- end[which(end > start)[1]] - 1
x[start:end]
}
extractMeta<-function(y){
#Make data frame to poplate
#df<-data.frame()
#Run getDate to get dates
dates<-map(y, getDate)
dates<-reduce(dates,c)
#Run getTitle to get Title
titles<-map(y, getTitle)
titles<-reduce(titles,c)
#Run Publication Title to get Publication Title
origin<-map(y, getPublication)
origin<-reduce(origin,c)
#Run get full text
text<-map(y, getFullText) %>%
map(., function(x) paste(x, collapse=""))
text<-reduce(text,c)
df<-data.frame(titles, dates, origin, text)
return(df)
}
extractMeta(out)
getFullText <- function(x){
start <- grep('Full [Tt]ext:', x)
end <- grep('[:alpha:]+:', x)
end <- end[which(end > start)[1]] - 1
x[start:end]
}
extractMeta<-function(y){
#Make data frame to poplate
#df<-data.frame()
#Run getDate to get dates
dates<-map(y, getDate)
dates<-reduce(dates,c)
#Run getTitle to get Title
titles<-map(y, getTitle)
titles<-reduce(titles,c)
#Run Publication Title to get Publication Title
origin<-map(y, getPublication)
origin<-reduce(origin,c)
#Run get full text
text<-map(y, getFullText) %>%
map(., function(x) paste(x, collapse=""))
text<-reduce(text,c)
df<-data.frame(titles, dates, origin, text)
return(df)
}
extractMeta(out)
getFullText <- function(x){
start <- grep('Full [Tt]ext:', x)
end <- grep(':', x)
end <- end[which(end > start)[1]] - 1
x[start:end]
}
extractMeta<-function(y){
#Make data frame to poplate
#df<-data.frame()
#Run getDate to get dates
dates<-map(y, getDate)
dates<-reduce(dates,c)
#Run getTitle to get Title
titles<-map(y, getTitle)
titles<-reduce(titles,c)
#Run Publication Title to get Publication Title
origin<-map(y, getPublication)
origin<-reduce(origin,c)
#Run get full text
text<-map(y, getFullText) %>%
map(., function(x) paste(x, collapse=""))
text<-reduce(text,c)
df<-data.frame(titles, dates, origin, text)
return(df)
}
extractMeta(out)
getID <- function(x){
id<-as.numeric(gsub('ProQuest document ID: ', '', grep('^^ProQuest document ID:', x, value=TRUE)))
}
getSection <- function(x){
section<-gsub('Section: ', '', grep('^Section: ', x, value=TRUE))
}
extractMeta<-function(y){
#Make data frame to poplate
#df<-data.frame()
#Run getDate to get dates
dates<-map(y, getDate)
dates<-reduce(dates,c)
#Run getTitle to get Title
titles<-map(y, getTitle)
titles<-reduce(titles,c)
#Run Publication Title to get Publication Title
origin<-map(y, getPublication)
origin<-reduce(origin,c)
#Run to get section
section<-map(y, getSection)
section<-reduce(origin,c)
#Run to get ProQuestID
id<-map(y, getID)
id<-reduce(origin,c)
#Run get full text
text<-map(y, getFullText) %>%
map(., function(x) paste(x, collapse=""))
text<-reduce(text,c)
df<-data.frame(titles, dates, origin, text, section, ID)
return(df)
}
extractMeta(out)
extractMeta<-function(y){
#Make data frame to poplate
#df<-data.frame()
#Run getDate to get dates
dates<-map(y, getDate)
dates<-reduce(dates,c)
#Run getTitle to get Title
titles<-map(y, getTitle)
titles<-reduce(titles,c)
#Run Publication Title to get Publication Title
origin<-map(y, getPublication)
origin<-reduce(origin,c)
#Run to get section
section<-map(y, getSection)
section<-reduce(origin,c)
#Run to get ProQuestID
ID<-map(y, getID)
ID<-reduce(ID,c)
#Run get full text
text<-map(y, getFullText) %>%
map(., function(x) paste(x, collapse=""))
text<-reduce(text,c)
df<-data.frame(titles, dates, origin, text, section, ID)
return(df)
}
extractMeta(out)
extractMeta<-function(y){
#Make data frame to poplate
#df<-data.frame()
#Run getDate to get dates
dates<-map(y, getDate)
dates<-reduce(dates,c)
#Run getTitle to get Title
titles<-map(y, getTitle)
titles<-reduce(titles,c)
#Run Publication Title to get Publication Title
origin<-map(y, getPublication)
origin<-reduce(origin,c)
#Run to get section
section<-map(y, getSection)
section<-reduce(origin,c)
#Run to get ProQuestID
ID<-map(y, getID)
ID<-reduce(ID,c)
#Run get full text
text<-map(y, getFullText) %>%
map(., function(x) paste(x, collapse=""))
text<-reduce(text,c)
df<-data.frame(titles, dates, origin, text, section)
return(df)
}
extractMeta(out)
extractMeta<-function(y){
#Make data frame to poplate
#df<-data.frame()
#Run getDate to get dates
dates<-map(y, getDate)
dates<-reduce(dates,c)
#Run getTitle to get Title
titles<-map(y, getTitle)
titles<-reduce(titles,c)
#Run Publication Title to get Publication Title
origin<-map(y, getPublication)
origin<-reduce(origin,c)
#Run to get section
section<-map(y, getSection)
section<-reduce(origin,c)
#Run to get ProQuestID
ID<-map(y, getID)
ID<-reduce(ID,c)
#Run get full text
text<-map(y, getFullText) %>%
map(., function(x) paste(x, collapse=""))
text<-reduce(text,c)
df<-data.frame(titles, dates, origin, text, section)
return(df)
}
test<-extractMeta(out)
summary(test)
out %>%
map(., getID)
out %>%
map(., getID) %>%
str()
out %>%
map(., getID)->ids
ids[[6]]
out %>%
map(., getID) %>%
View()
ids[[7]]
out[[7]]
getID <- function(x){
id<-as.numeric(gsub('ProQuest document ID: ', '', grep('^ProQuest document', x, value=TRUE)))
}
out[[7]]
getID <- function(x){
id<-as.numeric(gsub('ProQuest document ID: |ProQuest documentID', '', grep('^ProQuest document', x, value=TRUE)))
}
extractMeta<-function(y){
#Make data frame to poplate
#df<-data.frame()
#Run getDate to get dates
dates<-map(y, getDate)
dates<-reduce(dates,c)
#Run getTitle to get Title
titles<-map(y, getTitle)
titles<-reduce(titles,c)
#Run Publication Title to get Publication Title
origin<-map(y, getPublication)
origin<-reduce(origin,c)
#Run to get section
section<-map(y, getSection)
section<-reduce(origin,c)
#Run to get ProQuestID
ID<-map(y, getID)
ID<-reduce(ID,c)
#Run get full text
text<-map(y, getFullText) %>%
map(., function(x) paste(x, collapse=""))
text<-reduce(text,c)
df<-data.frame(titles, dates, origin, text, section, ID)
return(df)
}
test<-extractMeta(out)
glimpse(test)
library(tm)
library(quanteda)
corpus(test, text_field=text)
corpus(test, text_field="text")
star_corpus<-corpus(test, text_field="text")
prepare <- function(path="path_name") {
content<-readLines(path)
#Delete Superfluouous content
content <- content[1:(length(content) - 6)]
content<-content[grep("^Links:", content, invert=T)]
content<-content[grep("^https:", content, invert=T)]
content<-content[grep("^Abstract:", content, invert=T)]
content<-content[grep("^Language of", content, invert=T)]
content<-content[grep("^Document URL:", content, invert=T)]
content<-content[grep("^Copyright:", content, invert=T)]
content<-content[grep("^Last updated", content, invert=T)]
content<-content[grep("^Database:", content, invert=T)]
content<-content[grep("^Subject:", content, invert=T)]
content<-content[grep("^Publication info:", content, invert=T)]
content<-content[grep("^CAPTION:", content, invert=T)]
content<-content[grep("^CREDIT:", content, invert=T)]
content<-content[grep("^Publisher:", content, invert=T)]
content<-content[grep("^Place of:", content, invert=T)]
content<-content[grep("^Publication subject:", content, invert=T)]
content<-content[grep("^ISSN:", content, invert=T)]
content<-content[grep("^Publication year:", content, invert=T)]
content<-content[grep("^First page:", content, invert=T)]
content<-content[grep("^Business indexing:", content, invert=T)]
content<-content[grep("^Country of publication:", content, invert=T)]
content<-content[grep("^Place of publication:", content, invert=T)]
content <- content[grep(".", content)]
content<-content[grep("_______", content, invert=T)+1]
#Split the file at num
num <- cumsum(grepl("______________", content))
content <- split(content, num)
#Run the extract meta data
content<-extractMeta(content)
content
}
test<-prepare(path="inst/star.txt")
test
devtools:::document()
library(usethis)
use_package("purrr")
devtools:::document()
rm(list = c("extractMeta", "getDate", "getFullText", "getID", "getSection", "getTitle", "prepare"))
use_mit_license()
usethis::use_pipe()
devtools::document()
rm(list = c("getPublication"))
devtools::document()
?readLines
use_licence_mit()
usethis::use_licence_mit()
usethis::use_license_mit()
use_liense_mit()
usethis::use_license_mit()
usethis::use_mit_license()
library(ImportProquest)
